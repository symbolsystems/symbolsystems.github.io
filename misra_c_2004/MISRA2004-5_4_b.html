<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<LINK REL="stylesheet" HREF="book.css" TYPE="text/css">
<TITLE>
A tag name shall not be reused to define a different tag [MISRA2004-5_4_b]
</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF>
<STRONG>
A tag name shall not be reused to define a different tag [MISRA2004-5_4_b-3]
</STRONG>
<BR><BR>
<STRONG>
DESCRIPTION
</STRONG>
<PRE>

"No tag name shall be reused to define a different tag.
ISO 9899:1990 does not define the behaviour when an aggregate declaration uses
a tag in different forms of type specifier. Either all uses of the tag should
be in structure type specifiers, or all uses should be in union type specifiers"
[MISRA C:2004]

A "tag" is a name of a class, struct, union or enum type.

This rule reports a violation if the same name is used for more than one class,
struct, union or enum declaration in current translation unit.

See also: MISRA2004-5_4_a



</PRE>
<STRONG>
NOTES
</STRONG>
<PRE>

A typedef name is not recognized as a "tag" even if it designates a class,
struct, union or enum type. Such cases are checked by MISRA2004-5_4_a rule.



</PRE>
<STRONG>
BENEFITS
</STRONG>
<PRE>

Reuse of tag names can lead to errors and confusion.



</PRE>
<STRONG>
DRAWBACKS
</STRONG>
<PRE>

1. Rule checks only one translation unit at time. This means that if tag is
reused in a different translation unit then no violation will be reported.

</PRE>
<STRONG>
EXAMPLE
</STRONG>
<PRE>
    // file1.c:
    union stag { int i; long l; };
    // file2.c
    struct stag { long a; }; // Violation not reported - union stag declaration
                             // not visible in this translation unit

2. Following case is not supported:
    struct stag { ... };
    union stag x;            // Not reported


Example:

struct stag { int a; int b; };

void foo1()
{
    union stag  { int a; float b; }; // Violation
}

void foo2(void)
{
    struct stag { int a; };          // Violation
}

void foo3(void)
{
    struct stag { int a; int b; };   // Violation
}



</PRE>
<STRONG>
REPAIR
</STRONG>
<PRE>

struct stag { int a; int b; };

void foo1()
{
    union union_tag  { int a; float b; }; // OK
}

void foo2(void)
{
    struct new_stag { int a; };          // OK
}



</PRE>
<STRONG>
REFERENCES
</STRONG>
<PRE>

1. MISRA-C:2004 Guidelines for the use of the C language in critical systems
   Chapter 6, Section 5

</PRE>
</BODY>
</HTML>
