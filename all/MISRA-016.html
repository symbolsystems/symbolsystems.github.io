<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<LINK REL="stylesheet" HREF="book.css" TYPE="text/css">
<TITLE>
The underlying bit representations of floating point numbers shall not be used [MISRA-016]
</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF>
<STRONG>
The underlying bit representations of floating point numbers shall not be used [MISRA-016-3]
</STRONG>
<BR><BR>
<STRONG>
DESCRIPTION
</STRONG>
<PRE>

The underlying bit representations of floating point numbers shall not be used
in any way by the programmer.

This rule reports a violation if a pointer to a floating type is cast to
a pointer to an integer type. After such cast it is possible to use bit
operators on the converted integer.

"Manipulating the underlying bit representation of a floating point number is
error-prone, as representations may vary from compiler to compiler, and platform
to platform. There are, however, specific built-in operators and functions that
may be used to extract the mantissa and exponent of floating point values."
[Joint Strike Fighter, AV Rule 147]



</PRE>
<STRONG>
BENEFITS
</STRONG>
<PRE>

Prevents from casting with possible data losing.



</PRE>
<STRONG>
DRAWBACKS
</STRONG>
<PRE>

Rule reports on any casts from pointer to floating type to pointer to integer
type, even if the conversion is not done with intention of using underlying bit
representation.

Rule does not report violations on pointer-to-pointers, for example:
  void foo(int ** i, float ** f) {
    i = (int**)f; /* No violation reported */
  }



</PRE>
<STRONG>
EXAMPLE
</STRONG>
<PRE>

void foo() 
{
    int* pi;
    float* pf;
    double* pd;
    short int* ps;
    long * pl;

    pi = (int*)pf;    /* Violation */
    pi = (int*)pd;    /* Violation */
    ps = (short*)pf;  /* Violation */
    pl = (long*)pf;   /* Violation */
}



</PRE>
<STRONG>
REPAIR
</STRONG>
<PRE>

#include &lt;math.h&gt;
void bar(double x, double m)
{
  int n;
  m = frexp(x, &amp;n);
}

void foo() 
{
    int* pi;
    float* pf;
    double* pd;
    short int* ps;
	
    pf = (float*)pd;  /* OK */ 
    ps = (short*)pi;  /* OK */ 
}



</PRE>
<STRONG>
REFERENCES
</STRONG>
<PRE>

1. Origin: Misra Guidelines - Rule 16

2. JOINT STRIKE FIGHTER, AIR VEHICLE, C++ CODING STANDARDS
   Chapter 4.17 Types, AV Rule 147

</PRE>
</BODY>
</HTML>
