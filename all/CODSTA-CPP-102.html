<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<LINK REL="stylesheet" HREF="book.css" TYPE="text/css">
<TITLE>
A binary arithmetic operator and a bitwise operator shall return a 'prvalue' [CODSTA-CPP-102]
</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF>
<STRONG>
A binary arithmetic operator and a bitwise operator shall return a 'prvalue' [CODSTA-CPP-102-3]
</STRONG>
<BR><BR>
<STRONG>
DESCRIPTION
</STRONG>
<PRE>

Built-in binary arithmetic operators and bitwise operators return a pure
'rvalue' ('prvalue'). For this reason, overloaded binary arithmetic operators
and bitwise operators should also return a pure 'rvalue' to keep consistency
with the C++ Standard Library.

This rule detects overloaded binary arithmetic operators (+,-,/,*,%) and
bitwise operators (|, &amp;, ^) that return a type that is not a 'prvalue'.



</PRE>
<STRONG>
SINCE
</STRONG>
<PRE>

v10.4



</PRE>
<STRONG>
NOTES
</STRONG>
<PRE>

"A prvalue is an expression whose evaluation initializes an object
or a bit-field, or computes the value of the operand of an operator."
[AUTOSAR C Glossary]



</PRE>
<STRONG>
BENEFITS
</STRONG>
<PRE>

This rule helps you ensure that overloaded operators are consistent with their
corresponding built-in operators and produce expected results.



</PRE>
<STRONG>
EXAMPLE
</STRONG>
<PRE>

class A {
public:
    int m;
    volatile A operator-(int);                // Violation
    A* operator/(A const&amp; rhs);               // Violation
};

const A operator+(A const&amp; lhs, A const&amp; rhs) // Violation
{
    A temp;
    temp.m = lhs.m + rhs.m;
    return temp;
}

A&amp; operator*(A const&amp; lhs, A const&amp; rhs)      // Violation
{
    A temp;
    temp.m = lhs.m * rhs.m;
    return temp;
}



</PRE>
<STRONG>
REPAIR
</STRONG>
<PRE>

class A {
public:
    int m;
    A operator-(int);                   // OK
    A operator/(A const&amp; rhs);          // OK
};

A operator+(A const&amp; lhs, A const&amp; rhs) // OK
{
    A temp;
    temp.m = lhs.m + rhs.m;
    return temp;
}

A operator*(A const&amp; lhs, A const&amp; rhs) // OK
{
    A temp;
    temp.m = lhs.m * rhs.m;
    return temp;
}



</PRE>
<STRONG>
REFERENCES
</STRONG>
<PRE>

1. AUTOSAR C++14 Coding Guidelines
   A13-2-2. A binary arithmetic operator and a bitwise operator shall return a
   "prvalue"

2. High Integrity C++ Coding Standard
   13.2.2. Ensure that the return type of an overloaded binary operator
   matches the built-in counterparts

</PRE>
</BODY>
</HTML>
