<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<LINK REL="stylesheet" HREF="book.css" TYPE="text/css">
<TITLE>
All arguments to any type-generic macros declared in &lt;tgmath.h&gt; shall have appropriate essential type [CODSTA-108_c]
</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF>
<STRONG>
All arguments to any type-generic macros declared in &lt;tgmath.h&gt; shall have appropriate essential type [CODSTA-108_c-2]
</STRONG>
<BR><BR>
<STRONG>
DESCRIPTION
</STRONG>
<PRE>

"The operand arguments passed to the type-generic macros defined in &lt;tgmath.h&gt;
shall have essentially signed, essentially unsigned or essentially floating
(either essentially real floating or essentially complex floating) type.

Arguments to the following macros shall not have essentially complex floating
type: atan2, cbrt, ceil, copysign, erf, erfc, exp2, expm1, fdim, floor, fma,
fmax, fmin, fmod, frexp, hypot, ilogb, ldexp, lgamma, llrint, llround, log10,
log1p, log2, logb, lrint, lround, nearbyint, nextafter, nexttoward, remainder,
remquo, rint, round, scalbn, scalbln, tgamma, trunc.
The final parameter to the 'frexp' and 'remquo' macros is for output, and is not
considered an operand.

Arguments of non-arithmetic types are not convertible to any of the
corresponding real types defined for the macros defined in &lt;tgmath.h&gt;.
Attempting to use them therefore results in undefined behaviour.

Passing an essentially complex floating argument to one of the macros listed
in the amplification results in undefined behaviour."
[MISRA C:2012 Amendment 3]

This rule detects when arguments passed to calls of macros from the &lt;tgmath.h&gt;
header have a different essential type than essentially signed, essentially
unsigned or essentially floating type, or when arguments passed to macros atan2,
cbrt, ceil, copysign, erf, erfc, exp2, expm1, fdim, floor, fma, fmax, fmin,
fmod, frexp, hypot, ilogb, ldexp, lgamma, llrint, llround, log10, log1p, log2,
logb, lrint, lround, nearbyint, nextafter, nexttoward, remainder, remquo, rint,
round, scalbn, scalbln, tgamma, trunc have an essentially complex floating type.



</PRE>
<STRONG>
SINCE
</STRONG>
<PRE>

2022.2



</PRE>
<STRONG>
NOTES
</STRONG>
<PRE>

A violation can be reported when identifiers have the same names as macros
defined in the &lt;tgmath.h&gt; header file, but are not macros from this file,
for example:

// file1.h
#include &lt;math.h&gt;
char c;
void f(void)
{
    fabs(c);  // Reported, but 'fabs' is not a macro from &lt;tgmath.h&gt;
}

// file2.h
#include &lt;tgmath.h&gt;
//...

// file.c
#include "file1.h"
#include "file2.h"
//...



</PRE>
<STRONG>
EXCEPTIONS
</STRONG>
<PRE>

This rule does not apply to the second argument passed to the 'frexp' macro
call and to the third argument passed to the 'remquo' macro. These arguments
should have pointer types.



</PRE>
<STRONG>
BENEFITS
</STRONG>
<PRE>

This rule helps you prevent undefined behavior.



</PRE>
<STRONG>
EXAMPLE
</STRONG>
<PRE>

#include &lt;tgmath.h&gt;
#include &lt;stdbool.h&gt;

typedef enum E { E1, E2 } TE;

void f1()
{
    _Bool b;
    TE e;
    char c;

    fabs(b);           // Violation
    exp(e);            // Violation
    log(c);            // Violation
}



</PRE>
<STRONG>
REPAIR
</STRONG>
<PRE>

#include &lt;tgmath.h&gt;
#include &lt;stdbool.h&gt;

typedef enum E { E1, E2 } TE;

void f1()
{
    double d;
    TE e;
    signed char c;

    fabs(d);               // OK
    exp((unsigned int)e);  // OK
    log(c);                // OK
}



</PRE>
<STRONG>
REFERENCES
</STRONG>
<PRE>

1. MISRA C:2012 Amendment 3 Updates for ISO/IEC 9899:2011/2018
   Phase 2 - New C11/C18 Features
   2.3 Section 8 - Rules, 2.3.19 Rule 21.22

2. ISO/IEC 9899:2011 Programming languages -- C
   7.25 Type-generic math &lt;tgmath.h&gt;

</PRE>
</BODY>
</HTML>
