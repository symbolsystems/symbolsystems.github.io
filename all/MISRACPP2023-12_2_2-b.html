<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<LINK REL="stylesheet" HREF="book.css" TYPE="text/css">
<TITLE>
All enumeration values should be representable within the width of the bit-field [MISRACPP2023-12_2_2-b]
</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF>
<STRONG>
All enumeration values should be representable within the width of the bit-field [MISRACPP2023-12_2_2-b-2]
</STRONG>
<BR><BR>
<STRONG>
DESCRIPTION
</STRONG>
<PRE>

This rule detects when the bit-field type is enum and the size
of the bit-field is not big enough to represent all the enumeration
values of the enum type.



</PRE>
<STRONG>
SINCE
</STRONG>
<PRE>
2023.2



</PRE>
<STRONG>
NOTES
</STRONG>
<PRE>

This rule checks:
* scoped and unscoped enums
* enums whose underlying type is fixed and not fixed
* enums with signed and unsigned underlying type
  (also if signedness is implementation-defined)

If the enum type is an opaque enum declaration (which defines the enumeration
type but not its enumerators) for which no definition is provided in the
translation unit, the rule assumes that the bit-field requires
the same number of bits as the enum's underlying type.



</PRE>
<STRONG>
BENEFITS
</STRONG>
<PRE>

This rule helps you avoid unexpected behavior.



</PRE>
<STRONG>
EXAMPLE
</STRONG>
<PRE>

enum Line : unsigned char
{
    Plain,
    Dash,
    Dot
};
struct S
{
    // Cannot represent Dot:
    Line lineStyle : 1; // Violation
};

// Opaque enum declaration:
enum Colors : signed char;
struct R
{
    // Might not represent all Colors values:
    Colors brightColor : 4; // Violation
};

// Unnamed bit-fields:
struct Q
{
    Line : 1;   // Violation
    Colors : 1; // Violation
};



</PRE>
<STRONG>
REPAIR
</STRONG>
<PRE>

enum Line : unsigned char
{
    Plain,
    Dash,
    Dot
};
struct S
{
    Line lineStyle : 2; // OK
};

// Opaque enum declaration:
enum Colors : signed char;
struct R
{
    // Assuming signed char is 8 bit type:
    Colors brightColor : 8; // OK
};

// Unnamed bit-field
struct Q
{
    Line : 2;   // OK
    Colors : 8; // OK
};



</PRE>
<STRONG>
REFERENCES
</STRONG>
<PRE>

1. MISRA C++:2023 Guidelines for the use of C++17 in critical systems
   Rule 12.2.2 A bit-field shall have an appropriate type

</PRE>
</BODY>
</HTML>
