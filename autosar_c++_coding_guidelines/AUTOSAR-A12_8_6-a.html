<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<LINK REL="stylesheet" HREF="book.css" TYPE="text/css">
<TITLE>
Avoid public copy constructors and assignment operators in base classes [AUTOSAR-A12_8_6-a]
</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF>
<STRONG>
Avoid public copy constructors and assignment operators in base classes [AUTOSAR-A12_8_6-a-2]
</STRONG>
<BR><BR>
<STRONG>
DESCRIPTION
</STRONG>
<PRE>

"Sliced objects aren't good. (...) 
There is a better way that portably achieves the goal of preventing slicing
and delivers more value to boot. The more general idiomatic solution is to
make the copy constructor for base classes protected"
[C++ Coding Standards - Rule 54]
See also: OOP-02



</PRE>
<STRONG>
EXCEPTIONS
</STRONG>
<PRE>

"Some designs might require that the copy constructor of base classes
are left public. In that case, prefer passing by (smart) pointer to passing
by reference. Passing by pointer is much less vulnerable to slicing and
unwanted temporary construction."
[C++ Coding Standards - Rule 54]



</PRE>
<STRONG>
BENEFITS
</STRONG>
<PRE>

Rule prevents using of sliced objects.
"Object slicing is automatic, invisible, and likely to bring wonderful
polymorphic designs to a screeching halt"
[C++ Coding Standards - Rule 54]



</PRE>
<STRONG>
EXAMPLE
</STRONG>
<PRE>

class A
{
public:
    A(A&amp;);                     // Violation
    A&amp; operator=(const A&amp;);    // Violation
};

class B
{
public:
   B(B &amp;);                     // Violation
};

class C : public A
{
};

class D : public B
{
};


</PRE>
<STRONG>
REPAIR
</STRONG>
<PRE>

#include &lt;memory&gt;
using namespace std;

class A
{
protected:
    A(A&amp;);                     // OK
    A&amp; operator=(const A&amp;);    // OK
};

class B
{
public:
   B(auto_ptr&lt;B&gt;);             // OK - copy constructor in public section
                               // with smart pointer as parameter
};

class C : public A
{
};

class D : public B
{
};



</PRE>
<STRONG>
REFERENCES
</STRONG>
<PRE>

1. AUTOSAR C++14 Coding Guidelines
   A12-8-6. Copy and move constructors and copy assignment and move assignment
   operators shall be declared protected or defined "=delete" in base class

2. General Principles of Software Validation;
   Final Guidance for Industry and FDA Staff
   Document issued on: January 11, 2002

3. Herb Sutter, Andrei Alexandrescu, "C++ Coding Standards," Addison-Wesley, 
   (C) 2005 Pearson Education, Inc.
   Chapter: "Construction, Destruction, and Copying", Rule 54

</PRE>
</BODY>
</HTML>
