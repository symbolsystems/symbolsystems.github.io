<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<LINK REL="stylesheet" HREF="book.css" TYPE="text/css">
<TITLE>
Do not use the rand() function for generating pseudorandom numbers [AUTOSAR-A26_5_1-a]
</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF>
<STRONG>
Do not use the rand() function for generating pseudorandom numbers [AUTOSAR-A26_5_1-a-2]
</STRONG>
<BR><BR>
<STRONG>
DESCRIPTION
</STRONG>
<PRE>

"The C Standard rand() function makes no guarantees as to the quality
of the random sequence produced. The numbers generated by some
implementations of rand() have a comparatively short cycle and the numbers
can be predictable." [CERT-MSC30-C]

This rule detects when the rand() function from the C standard library
or the std::rand() function from the C++ standard library are used.



</PRE>
<STRONG>
BENEFITS
</STRONG>
<PRE>

This rule helps you avoid using the rand() function, which produces predictable
numbers and has limited randomness.
The rand() function uses the last generated number as the seed to create
the next number. This may enable an attacker to predict or calculate
the following numbers and gain access to privileged data.



</PRE>
<STRONG>
EXAMPLE
</STRONG>
<PRE>

#include &lt;stdlib.h&gt;

int foo( void )
{
    int y = rand();                   // Violation
    return y;
}



</PRE>
<STRONG>
REPAIR
</STRONG>
<PRE>

#include &lt;stdlib.h&gt;
#include &lt;time.h&gt;

int foo( void )
{
    int y;
    struct timespec ts;
    srandom(ts.tv_nsec ^ ts.tv_sec);
    y = random();                     // OK
    return y;
}



</PRE>
<STRONG>
REFERENCES
</STRONG>
<PRE>

1. AUTOSAR C++14 Coding Guidelines
   A26-5-1. Pseudorandom numbers shall not be generated using std::rand()

2. SEI CERT C Coding Standard
   MSC30-C. Do not use the rand() function for generating pseudorandom numbers
   <A HREF="https://wiki.sei.cmu.edu/confluence/display/c/MSC30-C.+Do+not+use+the+rand%28%29+function+for+generating+pseudorandom+numbers">https://wiki.sei.cmu.edu/confluence/display/c/MSC30-C.+Do+not+use+the+rand%28%29+function+for+generating+pseudorandom+numbers</A>

3. SEI CERT C++ Coding Standard
   MSC50-CPP. Do not use std::rand() for generating pseudorandom numbers
   <A HREF="https://wiki.sei.cmu.edu/confluence/display/cplusplus/MSC50-CPP.+Do+not+use+std%3A%3Arand%28%29+for+generating+pseudorandom+numbers">https://wiki.sei.cmu.edu/confluence/display/cplusplus/MSC50-CPP.+Do+not+use+std%3A%3Arand%28%29+for+generating+pseudorandom+numbers</A>

4. DISA Application Security and Development Security Technical Implementation Guide (STIG)
   APSC-DV-002290: The application must use the Federal Information Processing Standard (FIPS) 140-2-validated cryptographic modules 
   and random number generator if the application implements encryption, key exchange, digital signature, and hash functionality

</PRE>
</BODY>
</HTML>
